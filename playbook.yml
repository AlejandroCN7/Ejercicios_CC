---
  - hosts: Debian9
    become: yes
    pre_tasks:
      - name: Instala git
        apt:
          pkg: git
          state: present

      - name: Instalando herramientas necesarias
        sudo: yes
        apt:
          pkg: [wget,curl,python-minimal,python-setuptools,python-pip,python3-pip]
          state: present

    tasks:
      - name: Clonando repositorio github
        become: false
        git:
          repo: 'https://github.com/AlejandroCN7/Ejercicios_CC.git'
          clone: yes
          dest: /home/Alejandro/proyecto

      - name: Instalando dependencias del proyecto
        pip:
          requirements: /home/Alejandro/proyecto/requirements.txt
          executable: pip3

      - name: Redirigir puertos
        become: true
        lineinfile:
          path=/etc/rc.local
          insertbefore='exit 0'
          line="sudo iptables -t nat -I PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 5000"
